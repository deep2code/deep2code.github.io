<!DOCTYPE html>
<html lang="zh" class="js csstransforms3d">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="Hugo 0.101.0" />
    <meta name="description" content="">
<meta name="author" content="deep2code">

    <link rel="icon" href="/images/favicon.jpeg" type="image/jpeg">

    <title>git :: 技术博客</title>

    
    <link href="/css/nucleus.css?1677750506" rel="stylesheet">
    <link href="/css/fontawesome-all.min.css?1677750506" rel="stylesheet">
    <link href="/css/hybrid.css?1677750506" rel="stylesheet">
    <link href="/css/featherlight.min.css?1677750506" rel="stylesheet">
    <link href="/css/perfect-scrollbar.min.css?1677750506" rel="stylesheet">
    <link href="/css/auto-complete.css?1677750506" rel="stylesheet">
    <link href="/css/atom-one-dark-reasonable.css?1677750506" rel="stylesheet">
    <link href="/css/theme.css?1677750506" rel="stylesheet">
    <link href="/css/tabs.css?1677750506" rel="stylesheet">
    <link href="/css/hugo-theme.css?1677750506" rel="stylesheet">
    
    <link href="/css/theme-blue.css?1677750506" rel="stylesheet">
    
    

    <script src="/js/jquery-3.3.1.min.js?1677750506"></script>

    <style>
      :root #header + #content > #left > #rlblock_left{
          display:none !important;
      }
      
    </style>
    
  </head>
  <body class="" data-url="/git/">
    <nav id="sidebar" class="">



  <div id="header-wrapper">
    <div id="header">
      <a href="/"><img id="logo" src= "/images/logo.jpeg" ></img></a>
    </div>
    
        <div class="searchbox">
    <label for="search-by"><i class="fas fa-search"></i></label>
    <input data-search-input id="search-by" type="search" placeholder="">
    <span data-search-clear=""><i class="fas fa-times"></i></span>
</div>

<script type="text/javascript" src="/js/lunr.min.js?1677750506"></script>
<script type="text/javascript" src="/js/auto-complete.js?1677750506"></script>
<script type="text/javascript">
    
        var baseurl = "\/";
    
</script>
<script type="text/javascript" src="/js/search.js?1677750506"></script>

    
  </div>
  

    <div class="highlightable">
    <ul class="topics">

        
          
          




 
  
    
    <li data-nav-id="/ai/" title="Ais" class="dd-item
        
        
        
        ">
      <a href="/ai/">
          Ais
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/ai/__index/" title="ai" class="dd-item ">
        <a href="/ai/__index/">
        ai
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/elastic/" title="elastic" class="dd-item
        
        
        
        ">
      <a href="/elastic/">
          elastic
          
      </a>
      
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/flutter/" title="flutter" class="dd-item
        
        
        
        ">
      <a href="/flutter/">
          flutter
          
      </a>
      
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/git/" title="git" class="dd-item
        
        active
        
        ">
      <a href="/git/">
          git
          
      </a>
      
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/golang/" title="golang" class="dd-item
        
        
        
        ">
      <a href="/golang/">
          golang
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/golang/context/" title="context" class="dd-item ">
        <a href="/golang/context/">
        context
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/golang/echo/" title="echo" class="dd-item ">
        <a href="/golang/echo/">
        echo
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/golang/regexp/" title="exgexp包" class="dd-item ">
        <a href="/golang/regexp/">
        exgexp包
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/golang/freetype/" title="freetype" class="dd-item ">
        <a href="/golang/freetype/">
        freetype
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/golang/gin/" title="gin" class="dd-item ">
        <a href="/golang/gin/">
        gin
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/golang/go-git/" title="go-git" class="dd-item ">
        <a href="/golang/go-git/">
        go-git
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/golang/io/" title="io包" class="dd-item ">
        <a href="/golang/io/">
        io包
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/golang/iris/" title="iris" class="dd-item ">
        <a href="/golang/iris/">
        iris
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/golang/log/" title="log" class="dd-item ">
        <a href="/golang/log/">
        log
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/golang/shell/" title="shell" class="dd-item ">
        <a href="/golang/shell/">
        shell
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/golang/sort/" title="sort包" class="dd-item ">
        <a href="/golang/sort/">
        sort包
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/golang/stringer/" title="stringer" class="dd-item ">
        <a href="/golang/stringer/">
        stringer
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/golang/package/" title="常用包" class="dd-item ">
        <a href="/golang/package/">
        常用包
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/golang/code/" title="代码片断" class="dd-item ">
        <a href="/golang/code/">
        代码片断
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/golang/generic/" title="泛型" class="dd-item ">
        <a href="/golang/generic/">
        泛型
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/golang/groupby/" title="泛型切片分组" class="dd-item ">
        <a href="/golang/groupby/">
        泛型切片分组
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/grpc/" title="grpc" class="dd-item
        
        
        
        ">
      <a href="/grpc/">
          grpc
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/grpc/golang/" title="golang示例" class="dd-item ">
        <a href="/grpc/golang/">
        golang示例
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/mac/" title="mac" class="dd-item
        
        
        
        ">
      <a href="/mac/">
          mac
          
      </a>
      
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/memcached/" title="memcached" class="dd-item
        
        
        
        ">
      <a href="/memcached/">
          memcached
          
      </a>
      
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/mysql/" title="mysql" class="dd-item
        
        
        
        ">
      <a href="/mysql/">
          mysql
          
      </a>
      
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/nginx/" title="nginx" class="dd-item
        
        
        
        ">
      <a href="/nginx/">
          nginx
          
      </a>
      
      
        <ul>
          
          
            
          
          

        
          
            
            




 
  
    
    <li data-nav-id="/nginx/http/" title="HTTP模块" class="dd-item
        
        
        
        ">
      <a href="/nginx/http/">
          HTTP模块
          
      </a>
      
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/nginx/rtmp/" title="rtmp" class="dd-item
        
        
        
        ">
      <a href="/nginx/rtmp/">
          rtmp
          
      </a>
      
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/nginx/use/" title="常用技巧" class="dd-item
        
        
        
        ">
      <a href="/nginx/use/">
          常用技巧
          
      </a>
      
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/nginx/install/" title="源码安装剖析" class="dd-item
        
        
        
        ">
      <a href="/nginx/install/">
          源码安装剖析
          
      </a>
      
      
    </li>
  
 

            
          
        
        </ul>
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/python/" title="python" class="dd-item
        
        
        
        ">
      <a href="/python/">
          python
          
      </a>
      
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/redis/" title="redis" class="dd-item
        
        
        
        ">
      <a href="/redis/">
          redis
          
      </a>
      
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/other/" title="更多" class="dd-item
        
        
        
        ">
      <a href="/other/">
          更多
          
      </a>
      
      
        <ul>
          
          
            
          
          

        
          
            
            




 
  
    
    <li data-nav-id="/other/brew/" title="brew-酿制" class="dd-item
        
        
        
        ">
      <a href="/other/brew/">
          brew-酿制
          
      </a>
      
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/other/docker/" title="docker" class="dd-item
        
        
        
        ">
      <a href="/other/docker/">
          docker
          
      </a>
      
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/other/firefox/" title="firefox" class="dd-item
        
        
        
        ">
      <a href="/other/firefox/">
          firefox
          
      </a>
      
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/other/github/" title="github" class="dd-item
        
        
        
        ">
      <a href="/other/github/">
          github
          
      </a>
      
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/other/gitlab/" title="gitlab" class="dd-item
        
        
        
        ">
      <a href="/other/gitlab/">
          gitlab
          
      </a>
      
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/other/harbor/" title="harbor" class="dd-item
        
        
        
        ">
      <a href="/other/harbor/">
          harbor
          
      </a>
      
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/other/hugo/" title="hugo" class="dd-item
        
        
        
        ">
      <a href="/other/hugo/">
          hugo
          
      </a>
      
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/other/machinelearn/" title="machinelearn" class="dd-item
        
        
        
        ">
      <a href="/other/machinelearn/">
          machinelearn
          
      </a>
      
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/other/makefile/" title="makefile" class="dd-item
        
        
        
        ">
      <a href="/other/makefile/">
          makefile
          
      </a>
      
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/other/markdown/" title="markdown" class="dd-item
        
        
        
        ">
      <a href="/other/markdown/">
          markdown
          
      </a>
      
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/other/mermaid/" title="mermaid-美人鱼" class="dd-item
        
        
        
        ">
      <a href="/other/mermaid/">
          mermaid-美人鱼
          
      </a>
      
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/other/rpc/" title="rpc" class="dd-item
        
        
        
        ">
      <a href="/other/rpc/">
          rpc
          
      </a>
      
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/other/rust/" title="Rust" class="dd-item
        
        
        
        ">
      <a href="/other/rust/">
          Rust
          
      </a>
      
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/other/shell/" title="shell" class="dd-item
        
        
        
        ">
      <a href="/other/shell/">
          shell
          
      </a>
      
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/other/svn/" title="svn" class="dd-item
        
        
        
        ">
      <a href="/other/svn/">
          svn
          
      </a>
      
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/other/tesseract/" title="tesseract" class="dd-item
        
        
        
        ">
      <a href="/other/tesseract/">
          tesseract
          
      </a>
      
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/other/unity/" title="unity" class="dd-item
        
        
        
        ">
      <a href="/other/unity/">
          unity
          
      </a>
      
      
        <ul>
          
          
            
          
          

        
          
            
            




 
  
    
    <li data-nav-id="/other/unity/et/" title="ET框架" class="dd-item
        
        
        
        ">
      <a href="/other/unity/et/">
          ET框架
          
      </a>
      
      
    </li>
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/other/vim/" title="vim" class="dd-item
        
        
        
        ">
      <a href="/other/vim/">
          vim
          
      </a>
      
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/other/wasm/" title="wasm" class="dd-item
        
        
        
        ">
      <a href="/other/wasm/">
          wasm
          
      </a>
      
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/other/web/" title="web" class="dd-item
        
        
        
        ">
      <a href="/other/web/">
          web
          
      </a>
      
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/other/windows/" title="windows" class="dd-item
        
        
        
        ">
      <a href="/other/windows/">
          windows
          
      </a>
      
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/other/wireshark/" title="wireshark" class="dd-item
        
        
        
        ">
      <a href="/other/wireshark/">
          wireshark
          
      </a>
      
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/other/aliyun/" title="阿里云" class="dd-item
        
        
        
        ">
      <a href="/other/aliyun/">
          阿里云
          
      </a>
      
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/other/geocode/" title="地理编码" class="dd-item
        
        
        
        ">
      <a href="/other/geocode/">
          地理编码
          
      </a>
      
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/other/search/" title="搜索技巧" class="dd-item
        
        
        
        ">
      <a href="/other/search/">
          搜索技巧
          
      </a>
      
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/other/tencent/" title="腾讯" class="dd-item
        
        
        
        ">
      <a href="/other/tencent/">
          腾讯
          
      </a>
      
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/other/opensource/" title="优秀开源软件" class="dd-item
        
        
        
        ">
      <a href="/other/opensource/">
          优秀开源软件
          
      </a>
      
      
    </li>
  
 

            
          
        
        </ul>
      
    </li>
  
 

          
        
    </ul>

    
    

    
    <section id="footer">
      

    </section>
  </div>
</nav>




        <section id="body">
        <div id="overlay"></div>
        <div class="padding highlightable">
              
              <div>
                <div id="top-bar">
                
                
                <div id="breadcrumbs" itemscope="" itemtype="http://data-vocabulary.org/Breadcrumb">
                    <span id="sidebar-toggle-span">
                        <a href="#" id="sidebar-toggle" data-sidebar-toggle="">
                          <i class="fas fa-bars"></i>
                        </a>
                    </span>
                  
                  <span id="toc-menu"><i class="fas fa-list-alt"></i></span>
                  
                  <span class="links">
                 
                 
                    
          
          
            
            
          
          
            <a href='/'>主页</a> > git
          
        
          
        
                 
                  </span>
                </div>
                
                    <div class="progress">
    <div class="wrapper">
<nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li><a href="#优秀文档">优秀文档</a></li>
        <li><a href="#文件状态变迁图">文件状态变迁图</a></li>
        <li><a href="#命令介绍">命令介绍</a></li>
        <li><a href="#积累">积累</a></li>
        <li><a href="#多项目-一个项目采用git管理使用另一个项目采用git管理">多项目-一个项目(采用git管理)使用另一个项目(采用git管理)</a></li>
        <li><a href="#清除大文件">清除大文件</a></li>
        <li><a href="#清除未跟踪文件">清除未跟踪文件</a></li>
      </ul>
    </li>
  </ul>
</nav>
    </div>
</div>

                
              </div>
            </div>
            
        <div id="head-tags">
        
        </div>
        
        <div id="body-inner">
          
            <h1>
              
              git
            </h1>
          

        



	<h3 id="优秀文档">优秀文档</h3>
<ul>
<li>[git-scm]<a href="https://git-scm.com/book/zh/">https://git-scm.com/book/zh/</a>)</li>
</ul>
<h3 id="文件状态变迁图">文件状态变迁图</h3>
<p>
<div class="mermaid" align="center">

flowchart LR
    subgraph WorkDirectory
        ut(Untracked)
        um(Unmodified)--编辑修改-->md(Modified)
    end
    subgraph Staged
        s(Staged/Index)
    end
    subgraph Repo
        r(Commit对象)
    end
WorkDirectory --add--> Staged
Staged --restore或checkout--> WorkDirectory

Staged --commit--> Repo
Repo --restore或reset或checkout--> Staged

</div>

<img src="git_lint.webp" alt="git_lint"></p>

<div class="mermaid" align="center">
sequenceDiagram
    actor ut as Untracked
    actor um as Unmodified
    actor m as Modified
    actor s as Staged/Index
    actor r as Repo

    opt 未跟踪新文件
      ut->>s: add 跟踪
      ut-->>um: 自动转为
      r-->>s: 放弃跟踪 restore --staged或rm --cached
      um-->>ut: 放弃跟踪后自动转为
    end

    opt 已跟踪
      opt 已跟踪编辑
        um->>m: 编辑
        s-->>um: 放弃编辑 restore或checkout
      end

      opt 提交到stage/index
        m->>s: add
        r-->>s: 放弃add restore --staged或reset
      end
      r-->>um: 放弃add和编辑 restore --staged --worktree或checkout head
    end
    
    opt 提交repo
      s->>r: commit
      r-->>s: 放弃commit restore --source=HEAD~1 --staged或reset head~1
    end
    r-->>um: 放弃commit和add和编辑 restore --source=HEAD~1 --staged --worktree或checkout head~1或reset --hard head~1

</div>

<h3 id="命令介绍">命令介绍</h3>
<ul>
<li>
<p>git rm, 删除WorkDictory,Staged/Index的文件</p>
<ul>
<li>命令快照</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>git rm <span style="color:#f92672">[</span>--cached<span style="color:#f92672">]</span> &lt;pathspec&gt;...
</span></span></code></pre></div><ul>
<li>带上&ndash;cached，则只删除Staged/Index,否则WorkDictory也删除</li>
</ul>
</li>
<li>
<p>restore,从指定源恢复</p>
<ul>
<li>命令快照</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span> git restore <span style="color:#f92672">[</span>&lt;options&gt;<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>--source<span style="color:#f92672">=</span>&lt;tree&gt;<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>--staged<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>--worktree<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>--<span style="color:#f92672">]</span> &lt;pathspec&gt;...
</span></span></code></pre></div><ul>
<li>没有带上&ndash;staged,则直接从Staged/Index恢复到WorkDictory</li>
<li>带上&ndash;staged,则从repo(head或者source指定commit或tag)恢复到Staged/Index.如果同时要恢复WorkDictory,则带上&ndash;worktree</li>
<li>&ndash;source默认值为head</li>
<li>命令是试验性的,行为可能会改变.THIS COMMAND IS EXPERIMENTAL. THE BEHAVIOR MAY CHANGE.</li>
</ul>
</li>
<li>
<p>reset,设置head,Reset current HEAD to the specified state</p>
<ul>
<li>命令快照-格式1</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span> git reset <span style="color:#f92672">[</span>-q<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>&lt;tree-ish&gt;<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>--<span style="color:#f92672">]</span> &lt;pathspec&gt;
</span></span></code></pre></div><ul>
<li>
<p>从指定的tree-ish恢复到staged/index,tree-ish不指定就采用head</p>
</li>
<li>
<p>命令快照-格式2</p>
</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span> git reset <span style="color:#f92672">[</span>&lt;mode&gt;<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>&lt;commit&gt;<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>         This form resets the current branch head to &lt;commit&gt; and possibly updates the index <span style="color:#f92672">(</span>resetting it to the tree of &lt;commit&gt;<span style="color:#f92672">)</span> and the working tree depending on &lt;mode&gt;. If
</span></span><span style="display:flex;"><span>         &lt;mode&gt; is omitted, defaults to --mixed. The &lt;mode&gt; must be one of the following:
</span></span></code></pre></div><ul>
<li>把head指向tree-ish</li>
<li>mode不同值不同含义
<ul>
<li>&ndash;soft,仅改动head</li>
<li>&ndash;mixed(默认值),改动head并且staged/index恢复为指定tree-ish里面,workdictory不改</li>
<li>&ndash;herd,改动head并且staged/index,workdictory恢复为指定tree-ish里面</li>
</ul>
</li>
</ul>
</li>
<li>
<p>checkout,切换分支或恢复出指定文件</p>
<ul>
<li>命令快照-格式1</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>git checkout <span style="color:#f92672">[</span>-f|--ours|--theirs|-m|--conflict<span style="color:#f92672">=</span>&lt;style&gt;<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>&lt;tree-ish&gt;<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>--<span style="color:#f92672">]</span> &lt;pathspec&gt;
</span></span></code></pre></div><ul>
<li>
<p>没有带上tree-ish,则直接从Staged/Index恢复到WorkDictory</p>
</li>
<li>
<p>带上tree-ish,则从repo(tree-ish)恢复到Staged/Index和WorkDictory</p>
</li>
<li>
<p>tree-ish 通常是head,commit值或tag之类</p>
</li>
<li>
<p>命令快照-格式2</p>
</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>git checkout <span style="color:#f92672">[</span>-q<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>-f<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>-m<span style="color:#f92672">]</span> <span style="color:#f92672">[[</span>-b|-B|--orphan<span style="color:#f92672">]</span> &lt;new_branch&gt;<span style="color:#f92672">]</span>
</span></span></code></pre></div><ul>
<li>
<p>没有带上-b,则直接切换指定分支,分支必须存在</p>
</li>
<li>
<p>带上-b,则创建新分支,并且立即切换过去</p>
</li>
<li>
<p>命令快照-格式3</p>
</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span><span style="color:#75715e">#从远程仓库/分支,创建本地分支,分支名同远程分支一样,两者建立跟踪关系</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#切换到新分支,简化操作</span>
</span></span><span style="display:flex;"><span>git checkout --track remoteRepo/repoBranch
</span></span></code></pre></div></li>
<li>
<p>revert返祖,产生新的提交commit来返回过去的特定提交</p>
<ul>
<li>命令快照</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span> git revert <span style="color:#f92672">[</span>--<span style="color:#f92672">[</span>no-<span style="color:#f92672">]</span>edit<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>-n<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>-m parent-number<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>-s<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>-S<span style="color:#f92672">[</span>&lt;keyid&gt;<span style="color:#f92672">]]</span> &lt;commit&gt;
</span></span><span style="display:flex;"><span> git rever -m <span style="color:#ae81ff">1</span> head
</span></span></code></pre></div></li>
</ul>

<div class="mermaid" align="center">

flowchart LR
m1(commitXXXX) --commit--> m2(commitYYYY)
m2 --commit--> m3(commitZZZZ)
m3 --rever -m 1 head--> m4(commitNNNN,但内容和commitYYYY一样)

</div>

<ul>
<li>
<p>标签</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span><span style="color:#75715e">#列出标签</span>
</span></span><span style="display:flex;"><span>git tag
</span></span><span style="display:flex;"><span><span style="color:#75715e">#查看指定标签</span>
</span></span><span style="display:flex;"><span>git show vxxx
</span></span><span style="display:flex;"><span><span style="color:#75715e">#打轻量标签</span>
</span></span><span style="display:flex;"><span>git tag v1.0
</span></span><span style="display:flex;"><span><span style="color:#75715e">#打附注标签</span>
</span></span><span style="display:flex;"><span>git tag -a v2.0 -m <span style="color:#e6db74">&#34;附加信息&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#把标签vxxx推送到远程</span>
</span></span><span style="display:flex;"><span>git push origin vxxx
</span></span></code></pre></div></li>
<li>
<p>commit对象

<div class="mermaid" align="center">

flowchart LR
    subgraph commitXXXX
        direction TB
        cx(CommitXXXX)--包含-->tx(Tree对象)
        tx--包含-->bxa(Blob对象A)
        tx--包含-->bxb(Blob对象b)
        tx--包含-->bxc(Blob对象c)
    end
    subgraph commitYYYY
        direction TB
        cy(commitYYYY)--包含-->ty(Tree对象)
        ty--包含-->by1(Blob对象1)
        ty--包含-->by2(Blob对象2)
    end
    subgraph commitZZZZ
        direction TB
        cz(commitZZZZ)--包含-->tz(Tree对象)
        tz--包含-->bzl(Blob对象l)
        tz--包含-->bzm(Blob对象m)
        tz--包含-->bzn(Blob对象n)
        tz--包含-->bzo(Blob对象o)
    end
commitXXXX --父对象--> commitYYYY
commitYYYY --父对象--> commitZZZZ

</div>
</p>
</li>
<li>
<p>分支</p>
</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e">#列出分支</span>
</span></span><span style="display:flex;"><span>git branch
</span></span><span style="display:flex;"><span><span style="color:#75715e">#查看分支详情</span>
</span></span><span style="display:flex;"><span>git branch -vv
</span></span><span style="display:flex;"><span><span style="color:#75715e">#创建分支issue100</span>
</span></span><span style="display:flex;"><span>git branch issue100
</span></span><span style="display:flex;"><span><span style="color:#75715e">#跳到分支issue100</span>
</span></span><span style="display:flex;"><span>git checkout issue100
</span></span><span style="display:flex;"><span><span style="color:#75715e">#创建hotfix并且立即切过去</span>
</span></span><span style="display:flex;"><span>git checkout -b hotfix
</span></span><span style="display:flex;"><span><span style="color:#75715e">#删除分支issue100</span>
</span></span><span style="display:flex;"><span>git branch -d issue100
</span></span><span style="display:flex;"><span><span style="color:#75715e">#指定分支的跟踪远程分支</span>
</span></span><span style="display:flex;"><span>git branch --set-upstream-to<span style="color:#f92672">=</span>remote/branch branch
</span></span><span style="display:flex;"><span><span style="color:#75715e">#基于远程分支创建新分支并设置跟踪关系</span>
</span></span><span style="display:flex;"><span>git checkout --trace -b feature origin/feature
</span></span><span style="display:flex;"><span><span style="color:#75715e">#把hotfix分支合并到当前分支里</span>
</span></span><span style="display:flex;"><span>git merge hotfix
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 合并没有历史交并的分支</span>
</span></span><span style="display:flex;"><span>git merge gitee master --allow-unrelated-histories
</span></span><span style="display:flex;"><span><span style="color:#75715e">#如果合并冲突,则编辑修改冲突文件,再提交</span>
</span></span><span style="display:flex;"><span>git commit -am <span style="color:#e6db74">&#34;人工修改冲突&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#变基是改变-指定分支(不指出则采用当前分支)的起点,并且起点后的提交重播一次</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#以hotfix分支为起点,本分支已有提交重播一次,达到合并目的</span>
</span></span><span style="display:flex;"><span>git rebase hotfix
</span></span><span style="display:flex;"><span><span style="color:#75715e">#如果重播冲突,则编辑修改冲突文件,再提交</span>
</span></span><span style="display:flex;"><span>git commit -am <span style="color:#e6db74">&#34;人工修改冲突&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#解决冲突后提交,再继续完成变基操作</span>
</span></span><span style="display:flex;"><span>git rebase --continue
</span></span></code></pre></div><p><img src="git_rebase.webp" alt="git_rebase"></p>
<ul>
<li>
<p>rebase变基原则</p>
<ul>
<li>只对尚未推送或分享给别人的本地修改执行变基操作清理历史.</li>
<li>从不对已推送至别处的提交执行变基操作.</li>
</ul>
</li>
<li>
<p>合并提交</p>
</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>git commit -am <span style="color:#e6db74">&#34;first&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 编辑修改...</span>
</span></span><span style="display:flex;"><span>git commit -am <span style="color:#e6db74">&#34;second&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 编辑修改...</span>
</span></span><span style="display:flex;"><span>git commit -am <span style="color:#e6db74">&#34;three&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 交互式合并最近三个提交,如下图所示</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 默认从上到下，从旧到新列出来,可以编辑顺序</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 合并时从上到下执行，第一个一般是pack(基础)，其他的为s(合并到基础去,pack改为s)</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 退出保存后,会继续编辑合并信息.</span>
</span></span><span style="display:flex;"><span>git rebase -i head~3
</span></span></code></pre></div><p><img src="git_rebase_head.webp" alt="git_rebase"></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>git commit
</span></span><span style="display:flex;"><span>git branch dev
</span></span><span style="display:flex;"><span>git checkout dev
</span></span><span style="display:flex;"><span>git commit
</span></span><span style="display:flex;"><span>git commit
</span></span><span style="display:flex;"><span>git checkout master
</span></span><span style="display:flex;"><span>git commit
</span></span><span style="display:flex;"><span>git commit
</span></span><span style="display:flex;"><span>git commit
</span></span><span style="display:flex;"><span>git merge dev
</span></span></code></pre></div>
<div class="mermaid" align="center">

gitGraph:
options
{
    "nodeSpacing": 100,
    "nodeRadius": 10
}
end
commit
branch dev
checkout dev
commit
commit
checkout master
commit
commit
commit
merge dev

</div>

<ul>
<li>远程仓库</li>
</ul>

<div class="mermaid" align="center">

flowchart LR
    subgraph 本地仓库前
      lm(master)
      ld(dev)
    end
    subgraph 远程仓库
      rm(master)
      rd(dev)
      rh(hotfix)
    end
    subgraph 本地仓库后
      am(master)
      ad(dev)

      arm(origin/master)
      ard(origin/dev)
      arh(origin/hotfix)
    end
本地仓库前 --remote add orgin--> 远程仓库
本地仓库前 --fetch origin--> 本地仓库后

</div>

<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span><span style="color:#75715e">#添加远程库</span>
</span></span><span style="display:flex;"><span>git remote add name url
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 如果远程库有意外提交,可以强行合并进来,再推上去</span>
</span></span><span style="display:flex;"><span>git pull origin master --allow-unrelated-histories
</span></span><span style="display:flex;"><span><span style="color:#75715e">#拉取远程库内容</span>
</span></span><span style="display:flex;"><span>git fetch name
</span></span><span style="display:flex;"><span><span style="color:#75715e">#查看远程分支日志</span>
</span></span><span style="display:flex;"><span>git log name/branch
</span></span><span style="display:flex;"><span><span style="color:#75715e">#创建本地分支branch并且跟踪到远程分支</span>
</span></span><span style="display:flex;"><span>git checkout --track name/branch
</span></span><span style="display:flex;"><span><span style="color:#75715e">#推送到远程</span>
</span></span><span style="display:flex;"><span>git push
</span></span><span style="display:flex;"><span><span style="color:#75715e">#删除远程分支</span>
</span></span><span style="display:flex;"><span>git push name -d branch
</span></span><span style="display:flex;"><span><span style="color:#75715e">#查看本地分支与远程分支设置</span>
</span></span><span style="display:flex;"><span>git branch -vv
</span></span></code></pre></div><ul>
<li>集中式工作流程</li>
</ul>

<div class="mermaid" align="center">
sequenceDiagram
    actor da as 开发者A
    actor r as 仓库
    actor db as 开发者B

    da->>r: clone

    db->>r: clone

    da->>da: commit

    db->>db: commit

    da->>r: push

    db->>r: pull

    db->>r: push

</div>

<ul>
<li>pull-request工作流程,同一个仓库用不同分支替代仓库,类似流程</li>
</ul>

<div class="mermaid" align="center">
sequenceDiagram
    actor da as 开发者A
    actor dar as 开发者A仓库
    actor r as 仓库
    actor rw as 仓库维护者
    actor db as 开发者B
    actor dbr as 开发者B仓库

    opt 开发者A流程
      da->>r: fork
      r-->>dar: 自动创建
      da->>dar: clone
      da->>da: commit
      da-->>dar: push
      dar-->>r: pull requestA
      dar-->>rw: 通知
    end

    opt 开发者B流程
      db->>r: fork
      r-->>dbr: 自动创建
      db->>dbr: clone
      db->>db: commit
      db-->>dbr: push
      dbr-->>r: pull requestB
      dbr-->>rw: 通知
    end

    opt 仓库维护者流程
      rw->>r: merge pull requestA
      rw->>r: merge pull requestB
    end

</div>

<ul>
<li>储存栈</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span><span style="color:#75715e">#把workdirectory已跟踪修改+staged/index储存到一个栈上,</span>
</span></span><span style="display:flex;"><span>git stash
</span></span><span style="display:flex;"><span><span style="color:#75715e">#可以在任何一个干净状态恢复出来,不一定需要原来保存的分支里</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#不带上--index,则只恢复workdirectory已跟踪修改,</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#带上--index,则staged/index也一起恢复</span>
</span></span><span style="display:flex;"><span>git stash apply <span style="color:#f92672">[</span>--index<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#apply可以多次重复</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#删除就用drop</span>
</span></span><span style="display:flex;"><span>git stash drop
</span></span></code></pre></div><ul>
<li>杂项</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span><span style="color:#75715e">#配置本项目用户</span>
</span></span><span style="display:flex;"><span>git config user.name <span style="color:#e6db74">&#39;username&#39;</span>
</span></span><span style="display:flex;"><span>git config user.email <span style="color:#e6db74">&#39;username@xx.com&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 配置默认的分支名称</span>
</span></span><span style="display:flex;"><span>git config --global init.defaultBranch master   
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#修改最近提交的author</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#amend纠正最近一次提交</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#此次也会提交stage/index内容,如果stage/index没有修改,则直修改提交信息</span>
</span></span><span style="display:flex;"><span>git commit --amend --reset-author
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 查看最近3次提交文件变化情况</span>
</span></span><span style="display:flex;"><span>git log -3 --stat
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#查看指定文件提交记录</span>
</span></span><span style="display:flex;"><span>git log -p filename
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 查看该文件的相关commit</span>
</span></span><span style="display:flex;"><span>git log -- filename
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 查看指定提交特定文件的变化</span>
</span></span><span style="display:flex;"><span>git show commit_id filename
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 查看指定提交的变化</span>
</span></span><span style="display:flex;"><span>git show commit_id
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#比较两次提交之间指定目录的区别</span>
</span></span><span style="display:flex;"><span>git diff 26be34b 934d76fd flow/proto_file
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 有时候git status显示有变化,但是git diff没有,可能是文件换行符及文件权限属性变化了</span>
</span></span><span style="display:flex;"><span>git diff --cached filename
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#当前指定提交commit值</span>
</span></span><span style="display:flex;"><span>rem <span style="color:#e6db74">&#39;git rev-parse --short HEAD&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#记录本项目git版本,获取当前git版本值</span>
</span></span><span style="display:flex;"><span>Cgithash<span style="color:#f92672">=</span><span style="color:#e6db74">`</span>git rev-parse --short HEAD<span style="color:#e6db74">`</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#获取当前时间</span>
</span></span><span style="display:flex;"><span>Ctime<span style="color:#f92672">=</span><span style="color:#e6db74">`</span>date <span style="color:#e6db74">&#39;+%Y-%m-%d_%H:%M:%S&#39;</span><span style="color:#e6db74">`</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 强制退回指定commit</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#fa2850...是commit的hash值</span>
</span></span><span style="display:flex;"><span>git reset --hard fa285014d635190e74cd40fc798ce26243766a09
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#带用户名及密码的git clone</span>
</span></span><span style="display:flex;"><span>git clone http://uer:pwd@xxx.git
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 本地修改不提交到远程仓库</span>
</span></span><span style="display:flex;"><span>git update-index --skip-worktree filePath
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># post-receive钩子</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># git pull引入$GIT_DIR变量,因此需要取消变量</span>
</span></span><span style="display:flex;"><span>unset <span style="color:#66d9ef">$(</span>git rev-parse --local-env-vars<span style="color:#66d9ef">)</span>;
</span></span><span style="display:flex;"><span>git pull
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 查看特定提交在哪里分支</span>
</span></span><span style="display:flex;"><span>git branch --contains xxxx -all
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 创建一个空分支,没有任何父节点</span>
</span></span><span style="display:flex;"><span>git checkout --orphan newBranch
</span></span><span style="display:flex;"><span>git rm -rf .
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 如何没有任何文件提交，看不到新建的分支</span>
</span></span><span style="display:flex;"><span>git commit -am <span style="color:#e6db74">&#34;newBranch&#34;</span>
</span></span></code></pre></div><h3 id="积累">积累</h3>
<hr>
<ul>
<li>
<p><strong><a href="https://git-scm.com/">官网</a></strong></p>
</li>
<li>
<p>Git gc一般情况不用手动,gc主要把无用的内部对象回收,一般都自动处理</p>
</li>
<li>
<p>Git钩子都被存储在 Git 目录下的 hooks 子目录中.</p>
</li>
<li>
<p>.git目录内容
<img src="git_dir.webp" alt="git_dir"></p>
</li>
<li>
<p>git引用
<img src="git_refs.webp" alt="git_refs"></p>
</li>
<li>
<p>查看项目本地仓库,远程仓库,标签等</p>
</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>  tree .git/refs
</span></span></code></pre></div><p><img src="git_tree_refs.webp" alt="git_tree_refs"></p>
<ul>
<li>
<p>Git 可以使用四种不同的协议来传输资料：</p>
<ul>
<li>本地协议（Local）</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span><span style="color:#75715e">#本机clone,尽量采用不带file://前缀,加快速度</span>
</span></span><span style="display:flex;"><span>git clone /srv/git/project.git
</span></span><span style="display:flex;"><span>git clone file:///srv/git/project.git
</span></span></code></pre></div><ul>
<li>HTTP 协议，现在git一般采用智能 HTTP 协议</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>git clone https://example.com/gitproject.git
</span></span></code></pre></div><ul>
<li>SSH（Secure Shell）协议</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>git clone ssh://<span style="color:#f92672">[</span>user@<span style="color:#f92672">]</span>server/project.git
</span></span><span style="display:flex;"><span>git clone <span style="color:#f92672">[</span>user@<span style="color:#f92672">]</span>server:project.git
</span></span></code></pre></div><ul>
<li>Git 协议
<ul>
<li>Git里的一个特殊的守护进程,它监听在一个特定的端口（9418）</li>
<li>速度最快的</li>
<li>缺乏授权机制</li>
<li>git://</li>
</ul>
</li>
</ul>
</li>
<li>
<p>利用post-receive钩子自动更新</p>
</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>  <span style="color:#75715e">#!/usr/bin/env bash</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e"># post-receive脚本代码</span>
</span></span><span style="display:flex;"><span>  cd ~
</span></span><span style="display:flex;"><span>  target<span style="color:#f92672">=</span>xxx
</span></span><span style="display:flex;"><span>  <span style="color:#75715e"># 简单粗暴,删除旧目录</span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">if</span> <span style="color:#f92672">[</span> -d <span style="color:#e6db74">${</span>target<span style="color:#e6db74">}</span> <span style="color:#f92672">]</span>; <span style="color:#66d9ef">then</span>
</span></span><span style="display:flex;"><span>      rm -rf <span style="color:#e6db74">${</span>target<span style="color:#e6db74">}</span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">fi</span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e"># 重新建立,从git代码库目录</span>
</span></span><span style="display:flex;"><span>  git clone gogs-repositories/yyy/<span style="color:#e6db74">${</span>target<span style="color:#e6db74">}</span>.git
</span></span><span style="display:flex;"><span>  <span style="color:#75715e"># 杀死进程</span>
</span></span><span style="display:flex;"><span>  pkill <span style="color:#e6db74">${</span>target<span style="color:#e6db74">}</span>
</span></span><span style="display:flex;"><span>  cd <span style="color:#e6db74">${</span>target<span style="color:#e6db74">}</span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e"># 后台运行进程</span>
</span></span><span style="display:flex;"><span>  nohup ./<span style="color:#e6db74">${</span>target<span style="color:#e6db74">}</span> &gt;<span style="color:#e6db74">${</span>target<span style="color:#e6db74">}</span>.nohup 2&gt;&amp;<span style="color:#ae81ff">1</span> &amp;
</span></span></code></pre></div><ul>
<li>
<p>push碰到HTTP 413</p>
<ul>
<li>问题表现</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>Git push error: error: RPC failed; HTTP <span style="color:#ae81ff">413</span> curl <span style="color:#ae81ff">22</span> the requested URL returned error: <span style="color:#ae81ff">413</span>
</span></span></code></pre></div><ul>
<li>解决办法</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span><span style="color:#75715e"># 增加最大http长度</span>
</span></span><span style="display:flex;"><span>git config –global http.postBuffer <span style="color:#ae81ff">524288000</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-nginx" data-lang="nginx"><span style="display:flex;"><span><span style="color:#66d9ef">location</span> <span style="color:#e6db74">/</span> {
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">...</span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e"># 如果有nginx转发
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#e6db74">client_max_body_size</span> <span style="color:#e6db74">200M</span>;
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">...</span>
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">}</span>
</span></span></code></pre></div></li>
</ul>
<h3 id="多项目-一个项目采用git管理使用另一个项目采用git管理">多项目-一个项目(采用git管理)使用另一个项目(采用git管理)</h3>
<hr>
<ul>
<li>
<p>Git Submodule</p>
<ul>
<li>
<p>添加子目录</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span><span style="color:#75715e"># 默认在目录下建立repo子目录,并且克隆仓库,并且创建.gitmodules</span>
</span></span><span style="display:flex;"><span>git submodule add  https://xxx/repo.git
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 提交到仓库</span>
</span></span><span style="display:flex;"><span>git commit -am <span style="color:#e6db74">&#34;submodule&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 如果子项目有更新,直接取更新</span>
</span></span><span style="display:flex;"><span>git submodule update --remote
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 然后更新父目录,子项目引用到更新后的</span>
</span></span><span style="display:flex;"><span>git commit -am <span style="color:#e6db74">&#34;更新submodule&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#可以直接在子目录修改提交,和正常git操作一样</span>
</span></span></code></pre></div></li>
<li>
<p>其他人使用</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span><span style="color:#75715e"># 一次性克隆项目及子项目</span>
</span></span><span style="display:flex;"><span>git clone --recursive https://xxx/repo.git
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 或者先克隆项目</span>
</span></span><span style="display:flex;"><span>git clone  https://xxx.git
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 手动更新子项目</span>
</span></span><span style="display:flex;"><span>git submodule init
</span></span><span style="display:flex;"><span>git submodule update --remote
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#可以直接在子目录修改提交,和正常git操作一样</span>
</span></span></code></pre></div></li>
<li>
<p>子项目.git目录储存到父项目的.git/modules目录
<img src="git_submodules.webp" alt="git_submodules"></p>
</li>
<li>
<p>用引用方式,显式操作</p>
</li>
</ul>
</li>
<li>
<p>Git Subtree</p>
<ul>
<li>
<p>添加子目录，建立与git项目的关联</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span><span style="color:#75715e">#-f在添加远程仓库之后，立即执行fetch</span>
</span></span><span style="display:flex;"><span>git remote add -f &lt;子仓库名&gt; &lt;子仓库地址&gt;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#–squash意思是把subtree的改动合并成一次commit，不用拉取子项目完整的历史记录。</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#–prefix之后的=等号也可以用空格。</span>
</span></span><span style="display:flex;"><span>git subtree add --prefix<span style="color:#f92672">=</span>&lt;子目录名&gt; &lt;子仓库名&gt; &lt;分支&gt; --squash
</span></span></code></pre></div></li>
<li>
<p>从远程仓库更新子目录</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>git fetch &lt;远程仓库名&gt; &lt;分支&gt;
</span></span><span style="display:flex;"><span>git subtree pull --prefix<span style="color:#f92672">=</span>&lt;子目录名&gt; &lt;远程分支&gt; &lt;分支&gt; --squash
</span></span></code></pre></div></li>
<li>
<p>从子目录push到远程仓库（确认你有写权限）</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>git subtree push --prefix<span style="color:#f92672">=</span>&lt;子目录名&gt; &lt;远程分支名&gt; 分支
</span></span></code></pre></div></li>
<li>
<p>用复制方式,隐式操作</p>
</li>
</ul>
</li>
<li>
<p>GitSlave</p>
</li>
</ul>
<h3 id="清除大文件">清除大文件</h3>
<ul>
<li>
<p>采用工具</p>
</li>
<li>
<p>清理仓库大文件需要修改仓库的提交历史，git-filter-repo 是 Git 官方社区推荐的修改仓库提交历史的工具，本文介绍使用 git-filter-repo 来清理仓库大文件的方法。
<a href="https://help.aliyun.com/document_detail/369469.htm?spm=a2c4g.11186623.0.0.43d46980JHMUZq#topic-2156461">看他</a></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>  pip3 install git-filter-repo
</span></span></code></pre></div></li>
<li>
<p>手动执行</p>
</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 完全清除git中大文件提交</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 查看大文件</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 使用verify-pack命令查看, pack包里面的最大的10个文件对应的hash值</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 根据rev-list命令来查看, 最大的文件的文件名是什么</span>
</span></span><span style="display:flex;"><span>git rev-list --objects --all | grep <span style="color:#e6db74">&#34;</span><span style="color:#66d9ef">$(</span>git verify-pack -v .git/objects/pack/*.idx | sort -k <span style="color:#ae81ff">3</span> -n | tail -10 | awk <span style="color:#e6db74">&#39;{print$1}&#39;</span><span style="color:#66d9ef">)</span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 删除大文件</span>
</span></span><span style="display:flex;"><span>git filter-branch --force --index-filter <span style="color:#e6db74">&#34;git rm -rf --cached --ignore-unmatch linux_x86_64/zinc_upx&#34;</span> --prune-empty --tag-name-filter cat -- --all
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 回收空间，清理本地仓库不可达对象;</span>
</span></span><span style="display:flex;"><span>git <span style="color:#66d9ef">for</span>-each-ref --format<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;delete %(refname)&#39;</span> refs/original | git update-ref --stdin
</span></span><span style="display:flex;"><span>rm -rf .git/refs/original/
</span></span><span style="display:flex;"><span>rm -rf .git/logs/
</span></span><span style="display:flex;"><span>git reflog expire --expire<span style="color:#f92672">=</span>now --all
</span></span><span style="display:flex;"><span>git gc --prune<span style="color:#f92672">=</span>now
</span></span><span style="display:flex;"><span>git gc --aggressive --prune<span style="color:#f92672">=</span>now
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 强制推到远程</span>
</span></span><span style="display:flex;"><span>git push origin --force --all 
</span></span><span style="display:flex;"><span><span style="color:#75715e"># git push origin –-force --tag</span>
</span></span><span style="display:flex;"><span>git remote prune origin 
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># ！！清理完之后,每个人一定要删掉之前拉取的项目, 重新从git上拉项目。不要使用之前的项目了！否则会不降反升。</span>
</span></span></code></pre></div><h3 id="清除未跟踪文件">清除未跟踪文件</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e"># 清除文件</span>
</span></span><span style="display:flex;"><span>git clean -f
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 连目录也一起清除文件</span>
</span></span><span style="display:flex;"><span>git clean -fd
</span></span></code></pre></div>




<footer class=" footline" >
	
</footer>


</div>


</div>

<div id="navigation">
    
    

    
    
    
    
    
    
    
    

    
    
    
    
    

    
    
    
    
    
    
    
    
    
    
    

    
    
    

    
    
    
    
    
    
    
    

    
    
    

    
    
    
    
    
    
    
    
    
    
    
    
    
    

    
    
    

    
    
    
    
    
    
    
    
    
    
    

    
    
    

    
    
    
    
    
    
    
    
    
    
    
    

    
    
    

    
    
    
    
    
    
    
    
    
    
    
    
    
    

    
    
    

    
    
    
    
    
    
    
    

    
    
    

    
    
    
    
    
    
    
    
    
    
    

    
    
    

    
    
    
    
    
    
    
    
    
    
    

    
    
    

    
    
    
    
    
    
    
    
    
    
    

    
    
    

    
    
    
    
    
    
    
    
    
    
    

    
    
    

    
    
    
    
    
    
    
    
    
    
    

    
    
    

    
    
    
    
    
    
    
    
    
    
    

    
    
    

    
    
    
    
    
    
    
    
    
    
    

    
    
    

    
    
    
    
    
    
    
    
    
    
    

    
    
    

    
    
    
    
    
    
    
    
    
    
    

    
    
    

    
    
    
    
    
    
    
    
    
    
    

    
    
    

    
    
    
    
    
    
    
    
    
    
    

    
    
    

    
    
    
    
    
    
    
    
    
    
    

    
    
    

    
    
    
    
    
    
    
    
    
    
    

    
    
    

    
    
    
    
    
    
    
    
    
    
    

    
    
    

    
    
    
    
    
    
    
    
    
    
    

    
    
    

    
    
    
    
    
    
    
    
    
    
    
    
    
    

    
    
    

    
    
    
    
    
    
    
    

    
    
    

    
    
    
    
    
    
    
    
    
    
    
    
    
    

    
    
    

    
    
    
    
    
    
    
    
    
    
    

    
    
    

    
    
    
    
    
    
    
    
    
    
    

    
    
    

    
    
    
    
    
    
    
    
    
    
    

    
    
    
    
    

    
    
    
    
    
    
    
    

    
    
    

    
    
    
    
    
    
    
    
    
    
    

    
    
    

    
    
    
    
    
    
    
    
    
    
    

    
    
    

    
    
    
    
    
    
    
    
    
    
    

    
    
    

    
    
    
    
    
    
    
    
    
    
    
    
    
    

    
    
    

    
    
    
    
    
    
    
    
    
    
    

    
    
    

    
    
    
    
    
    
    
    
    
    
    

    
    
    
    
    

    
    
    
    
    
    
    
    

    
    
    

    
    
    
    
    
    
    
    
    
    
    

    
    
    

    
    
    
    
    
    
    
    
    
    
    

    
    
    

    
    
    
    
    
    
    
    
    
    
    

    
    
    

    
    
    
    
    
    
    
    
    
    
    

    
    
    

    
    
    
    
    
    
    
    
    
    
    

    
    
    

    
    
    
    
    
    
    
    
    
    
    

    
    
    

    
    
    
    
    
    
    
    
    
    
    

    
    
    

    
    
    
    
    
    
    
    
    
    
    

    
    
    

    
    
    
    
    
    
    
    
    
    
    

    
    
    

    
    
    
    
    
    
    
    
    
    
    

    
    
    

    
    
    
    
    
    
    
    
    
    
    

    
    
    

    
    
    
    
    
    
    
    
    
    
    

    
    
    

    
    
    
    
    
    
    
    
    
    
    

    
    
    

    
    
    
    
    
    
    
    
    
    
    

    
    
    

    
    
    
    
    
    
    
    
    
    
    

    
    
    

    
    
    
    
    
    
    
    
    
    
    

    
    
    
    
    

    
    
    
    
    
    
    
    

    
    
    

    
    
    
    
    
    
    
    
    
    
    
    
    
    

    
    
    

    
    
    
    
    
    
    
    
    
    
    

    
    
    

    
    
    
    
    
    
    
    
    
    
    

    
    
    

    
    
    
    
    
    
    
    
    
    
    

    
    
    

    
    
    
    
    
    
    
    
    
    
    

    
    
    

    
    
    
    
    
    
    
    
    
    
    

    
    
    

    
    
    
    
    
    
    
    
    
    
    

    
    
    

    
    
    
    
    
    
    
    
    
    
    

    
    
    

    
    
    
    
    
    
    
    
    
    
    

    
    
    

    
    
    
    
    
    
    
    
    
    
    

    
    
    

    
    
    
    
    
    
    
    
    

    


    
    
    
    <a class="nav nav-prev" href="/flutter/" title="flutter"> <i class="fa fa-chevron-left"></i></a>
    
    
    <a class="nav nav-next" href="/golang/" title="golang" style="margin-right: 0px;"><i
            class="fa fa-chevron-right"></i></a>
    
    
</div>

</section>

<div
    style="left: -1000px; overflow: scroll; position: absolute; top: -1000px; border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;">
    <div style="border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;"></div>
</div>
<script src="/js/clipboard.min.js?1677750506"></script>
<script src="/js/perfect-scrollbar.min.js?1677750506"></script>
<script src="/js/perfect-scrollbar.jquery.min.js?1677750506"></script>
<script src="/js/jquery.sticky.js?1677750506"></script>
<script src="/js/featherlight.min.js?1677750506"></script>
<script src="/js/highlight.pack.js?1677750506"></script>
<script>hljs.initHighlightingOnLoad();</script>
<script src="/js/modernizr.custom-3.6.0.js?1677750506"></script>
<script src="/js/learn.js?1677750506"></script>
<script src="/js/hugo-learn.js?1677750506"></script>


<script src="https://cdn.jsdelivr.net/npm/mermaid@8.14.0/dist/mermaid.min.js"></script>

<script>
    mermaid.initialize({
        startOnLoad: true,
        sequence: {showSequenceNumbers: true},
    });
</script>



</body>

</html>